width=.4,
position=position_dodge(.9)) + labs(x="IAPV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(.5, .9),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 0.5, y = 3000000, label = "A",cex = 6) + annotate(geom = "text", x = 1.25, y = 3000000, label = "A",cex = 6) + annotate(geom = "text", x = 1.25, y = 3000000, label = "B",cex = 6) + annotate(geom = "text", x = 2.25, y = 3000000, label = "B",cex = 6)
# merge figures into 1 side by side figure:
p3
p3 <- ggplot(splitVir$IAPV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="IAPV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(.5, .9),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 0.75, y = 3000000, label = "A",cex = 6) + annotate(geom = "text", x = 1.25, y = 3000000, label = "A",cex = 6) + annotate(geom = "text", x = 1.75, y = 3000000, label = "B",cex = 6) + annotate(geom = "text", x = 2.25, y = 3000000, label = "B",cex = 6)
p3
p3 <- ggplot(splitVir$IAPV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="IAPV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(.5, .9),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 0.8, y = 3000000, label = "B",cex = 6) + annotate(geom = "text", x = 1.25, y = 3000000, label = "A",cex = 6) + annotate(geom = "text", x = 1.75, y = 3000000, label = "A",cex = 6) + annotate(geom = "text", x = 2.25, y = 3000000, label = "B",cex = 6)
# merge figures into 1 side by side figure:
p3
p3 <- ggplot(splitVir$IAPV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="IAPV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(.5, .9),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 0.8, y = 3000000, label = "A",cex = 6) + annotate(geom = "text", x = 1.25, y = 3000000, label = "B",cex = 6) + annotate(geom = "text", x = 1.75, y = 3000000, label = "A",cex = 6) + annotate(geom = "text", x = 2.25, y = 3000000, label = "B",cex = 6)
p3
p3 <- ggplot(splitVir$IAPV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="IAPV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(.5, .9),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 0.78, y = 2800000, label = "A",cex = 6) + annotate(geom = "text", x = 1.2, y = 2500000, label = "B",cex = 6) + annotate(geom = "text", x = 1.78, y = 3200000, label = "A",cex = 6) + annotate(geom = "text", x = 2.2, y = 2500000, label = "B",cex = 6)
p3
p3 <- ggplot(splitVir$IAPV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="IAPV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(.5, .9),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 0.78, y = 2600000, label = "A",cex = 6) + annotate(geom = "text", x = 1.23, y = 2000000, label = "B",cex = 6) + annotate(geom = "text", x = 1.78, y = 3200000, label = "A",cex = 6) + annotate(geom = "text", x = 2.23, y = 2000000, label = "B",cex = 6)
# merge figures into 1 side by side figure:
p3
p3 <- ggplot(splitVir$IAPV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="IAPV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(.5, .9),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 0.78, y = 2600000, label = "A",cex = 6) + annotate(geom = "text", x = 1.23, y = 1700000, label = "B",cex = 6) + annotate(geom = "text", x = 1.78, y = 3200000, label = "A",cex = 6) + annotate(geom = "text", x = 2.23, y = 1900000, label = "B",cex = 6)
p3
p3 <- ggplot(splitVir$IAPV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="IAPV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(.5, .9),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 0.78, y = 2600000, label = "A",cex = 6) + annotate(geom = "text", x = 1.23, y = 1500000, label = "B",cex = 6) + annotate(geom = "text", x = 1.78, y = 3200000, label = "A",cex = 6) + annotate(geom = "text", x = 2.23, y = 1900000, label = "B",cex = 6)
p3
p3 <- ggplot(splitVir$IAPV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="IAPV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(.5, .9),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 0.78, y = 2600000, label = "A",cex = 6) + annotate(geom = "text", x = 1.23, y = 1500000, label = "B",cex = 6) + annotate(geom = "text", x = 1.78, y = 3300000, label = "A",cex = 6) + annotate(geom = "text", x = 2.23, y = 1900000, label = "B",cex = 6)
p3
# summary stats for plotting purposes:
VirusSummary <- ddply(VirusDF, c("Origin", "Virus", "Time"), summarise,
n = length(IntensityMult),
mean = mean(IntensityMult, na.rm = TRUE),
sd = sd(IntensityMult, na.rm = TRUE),
se = sd / sqrt(n))
# split data frame by virus type:
splitVir <- split(VirusSummary, VirusSummary$Virus)
#------------------------------------------------------------------------
#DWV
colors <- c("white", "gray32")
p1 <- ggplot(splitVir$DWV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="DWV", y = "Viral Load (band intensity)") + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(3, 3))
#------------------------------------------------------------------------
#BQCV
p2 <- ggplot(splitVir$BQCV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="BQCV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(3, 3),axis.text.y=element_blank(),
axis.ticks.y=element_blank())
#------------------------------------------------------------------------
#IAPV
p3 <- ggplot(splitVir$IAPV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="IAPV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(.5, .9),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 0.78, y = 2600000, label = "A",cex = 6) + annotate(geom = "text", x = 1.23, y = 1500000, label = "B",cex = 6) + annotate(geom = "text", x = 1.78, y = 3300000, label = "A",cex = 6) + annotate(geom = "text", x = 2.23, y = 1900000, label = "B",cex = 6)
# merge figures into 1 side by side figure:
grid.newpage()
grid.draw(cbind(ggplotGrob(p1), ggplotGrob(p2), ggplotGrob(p3), size = "last"))
# summary stats for plotting purposes:
VirusSummary <- ddply(VirusDF, c("Origin", "Virus", "Time"), summarise,
n = length(IntensityMult),
mean = mean(IntensityMult, na.rm = TRUE),
sd = sd(IntensityMult, na.rm = TRUE),
se = sd / sqrt(n))
# split data frame by virus type:
splitVir <- split(VirusSummary, VirusSummary$Virus)
#------------------------------------------------------------------------
#DWV
colors <- c("white", "gray32")
p1 <- ggplot(splitVir$DWV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="DWV", y = "Viral Load (band intensity)") + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(3, 3))
#------------------------------------------------------------------------
#BQCV
p2 <- ggplot(splitVir$BQCV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="BQCV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(3, 3),axis.text.y=element_blank(),
axis.ticks.y=element_blank())
#------------------------------------------------------------------------
#IAPV
p3 <- ggplot(splitVir$IAPV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="IAPV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(.5, .9),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 0.78, y = 2300000, label = "A",cex = 4) + annotate(geom = "text", x = 1.23, y = 1200000, label = "B",cex = 4) + annotate(geom = "text", x = 1.78, y = 3000000, label = "A",cex = 4) + annotate(geom = "text", x = 2.23, y = 1600000, label = "B",cex = 4)
# merge figures into 1 side by side figure:
grid.newpage()
grid.draw(cbind(ggplotGrob(p1), ggplotGrob(p2), ggplotGrob(p3), size = "last"))
#IAPV
p3 <- ggplot(splitVir$IAPV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="IAPV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(.5, .9),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 0.78, y = 2400000, label = "A",cex = 4) + annotate(geom = "text", x = 1.23, y = 1200000, label = "B",cex = 4) + annotate(geom = "text", x = 1.78, y = 3100000, label = "A",cex = 4) + annotate(geom = "text", x = 2.23, y = 1600000, label = "B",cex = 4)
# merge figures into 1 side by side figure:
grid.newpage()
grid.draw(cbind(ggplotGrob(p1), ggplotGrob(p2), ggplotGrob(p3), size = "last"))
p3 <- ggplot(splitVir$IAPV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="IAPV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(.5, .9),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 0.78, y = 2350000, label = "A",cex = 4) + annotate(geom = "text", x = 1.23, y = 1200000, label = "B",cex = 4) + annotate(geom = "text", x = 1.78, y = 3050000, label = "A",cex = 4) + annotate(geom = "text", x = 2.23, y = 1600000, label = "B",cex = 4)
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 0.78, y = 2350000, label = "A",cex = 4) + annotate(geom = "text", x = 1.23, y = 1200000, label = "B",cex = 4) + annotate(geom = "text", x = 1.78, y = 3050000, label = "A",cex = 4) + annotate(geom = "text", x = 2.23, y = 1600000, label = "B",cex = 4)
# merge figures into 1 side by side figure:
grid.newpage()
grid.draw(cbind(ggplotGrob(p1), ggplotGrob(p2), ggplotGrob(p3), size = "last"))
# summary stats for plotting purposes:
VirusSummary <- ddply(VirusDF, c("Origin", "Virus", "Time"), summarise,
n = length(IntensityMult),
mean = mean(IntensityMult, na.rm = TRUE),
sd = sd(IntensityMult, na.rm = TRUE),
se = sd / sqrt(n))
# split data frame by virus type:
splitVir <- split(VirusSummary, VirusSummary$Virus)
#------------------------------------------------------------------------
#DWV
colors <- c("white", "gray32")
p1 <- ggplot(splitVir$DWV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="DWV", y = "Viral Load (band intensity)") + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(3, 3))
#------------------------------------------------------------------------
#BQCV
p2 <- ggplot(splitVir$BQCV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="BQCV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(3, 3),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 1, y = 1800000, label = "A",cex = 4) + annotate(geom = "text", x = 2, y = 3500000, label = "B",cex = 4)
#------------------------------------------------------------------------
#IAPV
p3 <- ggplot(splitVir$IAPV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="IAPV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(.5, .9),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 0.78, y = 2350000, label = "A",cex = 4) + annotate(geom = "text", x = 1.23, y = 1200000, label = "B",cex = 4) + annotate(geom = "text", x = 1.78, y = 3050000, label = "A",cex = 4) + annotate(geom = "text", x = 2.23, y = 1600000, label = "B",cex = 4)
# merge figures into 1 side by side figure:
grid.newpage()
grid.draw(cbind(ggplotGrob(p1), ggplotGrob(p2), ggplotGrob(p3), size = "last"))
p2 <- ggplot(splitVir$BQCV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="BQCV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(3, 3),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 1, y = 1700000, label = "A",cex = 4) + annotate(geom = "text", x = 2, y = 3800000, label = "B",cex = 4)
#------------------------------------------------------------------------
#IAPV
p3 <- ggplot(splitVir$IAPV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="IAPV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(.5, .9),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 0.78, y = 2350000, label = "A",cex = 4) + annotate(geom = "text", x = 1.23, y = 1200000, label = "B",cex = 4) + annotate(geom = "text", x = 1.78, y = 3050000, label = "A",cex = 4) + annotate(geom = "text", x = 2.23, y = 1600000, label = "B",cex = 4)
# merge figures into 1 side by side figure:
grid.newpage()
grid.draw(cbind(ggplotGrob(p1), ggplotGrob(p2), ggplotGrob(p3), size = "last"))
# MASS
# summary stats for plotting purposes:
MassSummary <- ddply(QueenDF, c("Origin", "MassDay"), summarise,
n = length(Mass),
mean = mean(Mass, na.rm = TRUE),
sd = sd(Mass, na.rm = TRUE),
se = sd / sqrt(n))
# remove time steps with missing data:
MassSummary <- MassSummary[-c(5,10),]
print(MassSummary)
#------------------------------------------------------------------------
#Create plot in ggplot for mass without x label:
plot <- ggplot(data = MassSummary,
aes(x = MassDay,
y = mean,
group = Origin)
) + geom_point(size=3) + scale_colour_manual(values = c("black", "black")) + labs(x = NULL, y = "Colony Mass (lbs)", group="the") + coord_cartesian(ylim = c(20, 80), xlim = c(-5,70)) + geom_errorbar(aes(ymin = mean - se, ymax = mean + se, width = 0.9)) + geom_line(aes(linetype=Origin), size=1) + scale_fill_brewer(palette = "Paired") + theme_minimal(base_size = 17) + theme(legend.position=c(.15, .75), axis.title.y=element_text(margin=margin(0,20,0,0))) + scale_x_continuous(breaks=pretty_breaks(n=10)) + labs(linetype="Queen Origin") + annotate(geom = "text", x = 70, y = 75, label = "(a)",cex = 6)
#------------------------------------------------------------------------
# BROOD
# summary stats for plotting purposes:
BroodSummary <- ddply(QueenDF, c("Origin", "BroodDay"), summarise,
n = length(Brood),
mean = mean(Brood, na.rm = TRUE),
sd = sd(Brood, na.rm = TRUE),
se = sd / sqrt(n))
print(BroodSummary)
#------------------------------------------------------------------------
#Create plot in ggplot for brood
plot1 <- ggplot(data = BroodSummary,
aes(x = BroodDay,
y = mean,
group = Origin)
) + geom_point(size=3) + scale_colour_manual(values = c("black", "black")) + labs(x = "Time (days after requeening)", y = "Frames of Brood") + coord_cartesian(ylim = c(2, 7), xlim = c(-5,70)) + geom_errorbar(aes(ymin = mean - se, ymax = mean + se, width = 0.9)) + geom_line(aes(linetype=Origin), size=1) + scale_fill_brewer(palette = "Paired") + theme_minimal(base_size = 17) + theme(legend.position=c(3, 3), axis.title.y=element_text(margin=margin(0,20,0,0))) + scale_x_continuous(breaks=pretty_breaks(n=10)) + annotate(geom = "text", x = 70, y = 6.5, label = "(b)",cex = 6)
#------------------------------------------------------------------------
# use gridExtra package to combine the two figures:
library(gridExtra)
grid.newpage()
grid.draw(rbind(ggplotGrob(plot), ggplotGrob(plot1), size = "last"))
p2 <- ggplot(splitVir$BQCV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="BQCV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(3, 3),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 1, y = 1700000, label = "A",cex = 4) + annotate(geom = "text", x = 2, y = 3800000, label = "B",cex = 4) + + annotate("segment", x = 2.5, xend = 4, y = 15, yend = 2)
#------------------------------------------------------------------------
p2 <- ggplot(splitVir$BQCV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="BQCV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(3, 3),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 1, y = 1700000, label = "A",cex = 4) + annotate(geom = "text", x = 2, y = 3800000, label = "B",cex = 4) + + annotate("segment", x = 2.5, xend = 4, y = 15, yend = 25)
p2 <- ggplot(splitVir$BQCV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="BQCV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(3, 3),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 1, y = 1700000, label = "A",cex = 4) + annotate(geom = "text", x = 2, y = 3800000, label = "B",cex = 4) + annotate("segment", x = 2.5, xend = 4, y = 15, yend = 25)
p2
p2 <- ggplot(splitVir$BQCV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="BQCV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(3, 3),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 1, y = 1700000, label = "A",cex = 4) + annotate(geom = "text", x = 2, y = 3800000, label = "B",cex = 4) + annotate("segment", x = 2.5, xend = 4, y = 3000000, yend = 2)
p2
p2 <- ggplot(splitVir$BQCV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="BQCV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(3, 3),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 1, y = 1700000, label = "A",cex = 4) + annotate(geom = "text", x = 2, y = 3800000, label = "B",cex = 4) + annotate("segment", x = 2.5, xend = 4, y = 3000000, yend = 3000000)
p2
p2 <- ggplot(splitVir$BQCV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="BQCV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(3, 3),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 1, y = 1700000, label = "A",cex = 4) + annotate(geom = "text", x = 2, y = 3800000, label = "B",cex = 4) + annotate("segment", x = 1, xend = 2, y = 3500000, yend = 3500000)
p2
p2 <- ggplot(splitVir$BQCV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="BQCV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(3, 3),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 1, y = 1700000, label = "A",cex = 4) + annotate(geom = "text", x = 2, y = 3800000, label = "B",cex = 4) + annotate("segment", x = 1, xend = 2, y = 3800000, yend = 3800000)
p2
p2 <- ggplot(splitVir$BQCV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="BQCV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(3, 3),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 1, y = 1700000, label = "A",cex = 4) + annotate(geom = "text", x = 2, y = 3800000, label = "B",cex = 4) + annotate("segment", x = 1, xend = 2, y = 4000000, yend = 4000000)
p2
p2 <- ggplot(splitVir$BQCV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="BQCV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(3, 3),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 1.5, y = 4100000, label = "***",cex = 4) + annotate("segment", x = 1, xend = 2, y = 4000000, yend = 4000000)
p2
p2 <- ggplot(splitVir$BQCV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="BQCV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(3, 3),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 1.5, y = 4100000, label = "***",cex = 5) + annotate("segment", x = 1, xend = 2, y = 4000000, yend = 4000000)
p2
p2 <- ggplot(splitVir$BQCV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="BQCV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(3, 3),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 1.5, y = 4100000, label = "***",cex = 6) + annotate("segment", x = 1, xend = 2, y = 4000000, yend = 4000000)
p2
p2 <- ggplot(splitVir$BQCV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="BQCV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(3, 3),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 1.5, y = 4100000, label = "***",cex = 6) + annotate("segment", x = 1, xend = 2, y = 4000000, yend = 4000000) + annotate("segment", x = 1, xend = 1, y = 4000000, yend = 1800000)
p2
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 1.5, y = 4100000, label = "***",cex = 6) + annotate("segment", x = 1, xend = 2, y = 4000000, yend = 4000000) + annotate("segment", x = 1, xend = 1, y = 4000000, yend = 2500000)
p2 <- ggplot(splitVir$BQCV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="BQCV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(3, 3),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 1.5, y = 4100000, label = "***",cex = 6) + annotate("segment", x = 1, xend = 2, y = 4000000, yend = 4000000) + annotate("segment", x = 1, xend = 1, y = 4000000, yend = 2500000)
p2
p2 <- ggplot(splitVir$BQCV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="BQCV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(3, 3),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 1.5, y = 4100000, label = "***",cex = 6) + annotate("segment", x = 1, xend = 2, y = 4000000, yend = 4000000) + annotate("segment", x = 1, xend = 1, y = 4000000, yend = 2200000) + annotate("segment", x = 2, xend = 2, y = 4000000, yend = 3800000)
p2
p2 <- ggplot(splitVir$BQCV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="BQCV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(3, 3),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 1.5, y = 4100000, label = "***",cex = 6) + annotate("segment", x = 1, xend = 2, y = 4000000, yend = 4000000) + annotate("segment", x = 1, xend = 1, y = 4000000, yend = 2200000) + annotate("segment", x = 2, xend = 2, y = 4000000, yend = 3700000)
p2
p2 <- ggplot(splitVir$BQCV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="BQCV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(3, 3),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 1.5, y = 4100000, label = "***",cex = 6) + annotate("segment", x = 1, xend = 2, y = 4000000, yend = 4000000) + annotate("segment", x = 1, xend = 1, y = 4000000, yend = 1800000) + annotate("segment", x = 2, xend = 2, y = 4000000, yend = 3700000)
p2
p3 <- ggplot(splitVir$IAPV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="IAPV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(.5, .9),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 0.78, y = 2350000, label = "A",cex = 4) + annotate(geom = "text", x = 1.23, y = 1200000, label = "B",cex = 4) + annotate(geom = "text", x = 1.78, y = 3050000, label = "A",cex = 4) + annotate(geom = "text", x = 2.23, y = 1600000, label = "B",cex = 4)
# merge figures into 1 side by side figure:
grid.newpage()
grid.draw(cbind(ggplotGrob(p1), ggplotGrob(p2), ggplotGrob(p3), size = "last"))
p2 <- ggplot(splitVir$BQCV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="BQCV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(3, 3),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 1.5, y = 3900000, label = "***",cex = 6) + annotate("segment", x = 1, xend = 2, y = 3800000, yend = 3800000) + annotate("segment", x = 1, xend = 1, y = 3800000, yend = 1600000) + annotate("segment", x = 2, xend = 2, y = 3800000, yend = 3500000)
#------------------------------------------------------------------------
#IAPV
p3 <- ggplot(splitVir$IAPV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="IAPV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(.5, .9),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 0.78, y = 2350000, label = "A",cex = 4) + annotate(geom = "text", x = 1.23, y = 1200000, label = "B",cex = 4) + annotate(geom = "text", x = 1.78, y = 3050000, label = "A",cex = 4) + annotate(geom = "text", x = 2.23, y = 1600000, label = "B",cex = 4)
# merge figures into 1 side by side figure:
grid.newpage()
grid.draw(cbind(ggplotGrob(p1), ggplotGrob(p2), ggplotGrob(p3), size = "last"))
p2 <- ggplot(splitVir$BQCV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="BQCV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(3, 3),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 1.5, y = 3900000, label = "***",cex = 6) + annotate("segment", x = 1, xend = 2, y = 3800000, yend = 3800000) + annotate("segment", x = 1, xend = 1, y = 3800000, yend = 1500000) + annotate("segment", x = 2, xend = 2, y = 3800000, yend = 3500000)
#------------------------------------------------------------------------
#IAPV
p3 <- ggplot(splitVir$IAPV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="IAPV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(.5, .9),axis.text.y=element_blank(),
axis.ticks.y=element_blank()) + annotate(geom = "text", x = 0.78, y = 2350000, label = "A",cex = 4) + annotate(geom = "text", x = 1.23, y = 1200000, label = "B",cex = 4) + annotate(geom = "text", x = 1.78, y = 3050000, label = "A",cex = 4) + annotate(geom = "text", x = 2.23, y = 1600000, label = "B",cex = 4)
# merge figures into 1 side by side figure:
grid.newpage()
grid.draw(cbind(ggplotGrob(p1), ggplotGrob(p2), ggplotGrob(p3), size = "last"))
# summary stats for plotting purposes:
VirusSummary <- ddply(VirusDF, c("Origin", "Virus", "Time"), summarise,
n = length(IntensityMult),
mean = mean(IntensityMult, na.rm = TRUE),
sd = sd(IntensityMult, na.rm = TRUE),
se = sd / sqrt(n))
# split data frame by virus type:
splitVir <- split(VirusSummary, VirusSummary$Virus)
#------------------------------------------------------------------------
#DWV
colors <- c("white", "gray32")
p1 <- ggplot(splitVir$DWV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="DWV", y = "Viral Load (band intensity)") + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(3, 3))
#------------------------------------------------------------------------
#BQCV
p2 <- ggplot(splitVir$BQCV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="BQCV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(3, 3)) + annotate(geom = "text", x = 1.5, y = 3900000, label = "***",cex = 6) + annotate("segment", x = 1, xend = 2, y = 3800000, yend = 3800000) + annotate("segment", x = 1, xend = 1, y = 3800000, yend = 1500000) + annotate("segment", x = 2, xend = 2, y = 3800000, yend = 3500000)
#------------------------------------------------------------------------
#IAPV
p3 <- ggplot(splitVir$IAPV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="IAPV", y = NULL) + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(.5, .9)) + annotate(geom = "text", x = 0.78, y = 2350000, label = "A",cex = 4) + annotate(geom = "text", x = 1.23, y = 1200000, label = "B",cex = 4) + annotate(geom = "text", x = 1.78, y = 3050000, label = "A",cex = 4) + annotate(geom = "text", x = 2.23, y = 1600000, label = "B",cex = 4)
# merge figures into 1 side by side figure:
grid.newpage()
grid.draw(cbind(ggplotGrob(p1), ggplotGrob(p2), ggplotGrob(p3), size = "last"))
# summary stats for plotting purposes:
VirusSummary <- ddply(VirusDF, c("Origin", "Virus", "Time"), summarise,
n = length(IntensityMult),
mean = mean(IntensityMult, na.rm = TRUE),
sd = sd(IntensityMult, na.rm = TRUE),
se = sd / sqrt(n))
# split data frame by virus type:
splitVir <- split(VirusSummary, VirusSummary$Virus)
#------------------------------------------------------------------------
#DWV
colors <- c("white", "gray32")
p1 <- ggplot(splitVir$DWV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="DWV", y = "Viral Load (band intensity)") + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(3, 3))
#------------------------------------------------------------------------
#BQCV
p2 <- ggplot(splitVir$BQCV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="BQCV", y = "Viral Load (band intensity)") + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(3, 3)) + annotate(geom = "text", x = 1.5, y = 3900000, label = "***",cex = 6) + annotate("segment", x = 1, xend = 2, y = 3800000, yend = 3800000) + annotate("segment", x = 1, xend = 1, y = 3800000, yend = 1500000) + annotate("segment", x = 2, xend = 2, y = 3800000, yend = 3500000)
#------------------------------------------------------------------------
#IAPV
p3 <- ggplot(splitVir$IAPV, aes(x=Time, y=mean, fill=Origin)) +
geom_bar(stat="identity", col="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-se, ymax=mean+se),
width=.4,
position=position_dodge(.9)) + labs(x="IAPV", y = "Viral Load (band intensity)") + theme_minimal(base_size = 17) + coord_cartesian(ylim = c(0, 4000000)) + scale_fill_manual(values=colors, name="Queen Origin", labels=c("California", "Local")) + theme(legend.position=c(.5, .9)) + annotate(geom = "text", x = 0.78, y = 2350000, label = "A",cex = 4) + annotate(geom = "text", x = 1.23, y = 1200000, label = "B",cex = 4) + annotate(geom = "text", x = 1.78, y = 3050000, label = "A",cex = 4) + annotate(geom = "text", x = 2.23, y = 1600000, label = "B",cex = 4)
# merge figures into 1 side by side figure:
grid.newpage()
grid.draw(cbind(ggplotGrob(p1), ggplotGrob(p2), ggplotGrob(p3), size = "last"))
